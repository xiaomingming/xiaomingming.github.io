<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>归档：2014 | xiaoming&#39;s blog</title>
  <meta name="author" content="xiaoming">
  
  
  <meta name="viewport" content="width=device-width; initial-scale=1; maximum-scale=1">

  
  <meta property="og:site_name" content="xiaoming&#39;s blog"/>

  <link rel="alternate" href="/atom.xml" title="xiaoming&#39;s blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
  
</head>

<body>
  <header id="header" class="inner"><!-- fork me  -->
<a href="https://github.com/xiaomingming"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
<!-- 返回顶部  -->
<a id="goto-top" href="#" style=" display:none; position:fixed; bottom:10px; right:10px; width:14px; padding: 6px; background:#333; color:#fff; border-radius:3px;">返回顶部</a>
<div class="alignleft">
<h1><a href="/">xiaoming&#39;s blog</a></h1>
<script src="/js/prefixfree.min.js"></script>

</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <a href="/"><li>Home</li></a>
    
      <a href="/archives"><li>Archives</li></a>
    
  </ul>
  <div class="clearfix"></div>
</nav>


<div class="clearfix"></div></header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
<h2 class="archive-title">2014</h2>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T07:40:22.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/object-enumberable-properties/">javascript对象属性枚举</a></h1>
  

    </header>
    <div class="entry">
      
        <p>对于属性和方法的枚举，以前是用的<code>for in</code>来枚举，但是有些过时了。<br>这里介绍下枚举存在的一些概念和问题。</p>
<h2 id="一、枚举和不可枚举">一、枚举和不可枚举</h2>
<p>既然可以枚举，那么肯定也有不能枚举的可能。</p>
<p>javascript中，哪个对象的可枚举属性<code>[[Enumberable]]</code>为<code>true</code>为真时，就意味着它是可以枚举的。否则不可枚举（Es5有可枚举的方法）。</p>
<p><code>obj.hasOwnProperty(key)</code>过滤的是非自身属性，自身属性是实例化得来的，不是从原型链上继承来的。</p>
<h2 id="二、枚举方法">二、枚举方法</h2>
<p>Es5提供了两种方法来进行对象属性枚举，分别为:</p>
<ul>
<li><code>Object.keys(obj)</code>：只能枚举实例属性，类似 <code>for-in</code>和<code>obj.hasOwnProperty(key)</code>枚举过滤。</li>
<li><code>Object.getOwnPropertyNames(obj)</code>：只能枚举实例属性，但是不受属性<code>[[Enumberable]]</code>的影响。</li>
</ul>
<p>Ps：注意，“实例属性”也包括原型对象。</p>
<h2 id="三、枚举实例">三、枚举实例</h2>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="keyword">var</span> Person=<span class="function"><span class="keyword">function</span><span class="params">(x)</span>{</span>
    <span class="keyword">this</span>.name=x;
};
Person.prototype.name=<span class="string">'xiaoqiang'</span>;
Person.prototype.age=<span class="number">23</span>;
Person.prototype.sayName=<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.name;
};
<span class="keyword">var</span> person1=<span class="keyword">new</span> Person();
<span class="keyword">var</span> person2=<span class="keyword">new</span> Person();
person1.sayName();
person2.sayName();
<span class="comment">// alert(person1.sayName===person2.sayName);//true</span>
console.log(<span class="built_in">Object</span>.keys(person1));<span class="comment">//name，尽管没有初始化，但是依然可以枚举出来</span>
console.log(<span class="built_in">Object</span>.keys(Person.prototype));<span class="comment">//["name", "age", "sayName"] </span>
console.log(<span class="built_in">Object</span>.getOwnPropertyNames(person1));<span class="comment">//name</span>
console.log(<span class="built_in">Object</span>.getOwnPropertyNames(Person.prototype))<span class="comment">//["constructor", "name", "age", "sayName"]</span>
</pre></td></tr></table></figure>

<p>其它参考：</p>
<p><a href="http://www.cnblogs.com/ziyunfei/archive/2012/11/03/2752905.html" target="_blank">http://www.cnblogs.com/ziyunfei/archive/2012/11/03/2752905.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T07:33:46.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/javascript-closure/">javascript 闭包理解</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="一、概念">一、概念</h2>
<p>一句话：就是包裹函数内部的函数访问包裹函数内（非内嵌函数体中）的变量，并返回该内部函数（看来此话不对啊）。<br>应当是：函数访问其外部变量，并持有该变量。</p>
<h2 id="二、传值情形">二、传值情形</h2>
<h3 id="1-值传递情形">1.值传递情形</h3>
<p>并不是一个包裹函数体中的内部函数访问其外部的变量，就算作是闭包了。比如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(x)</span> {</span>
    <span class="keyword">var</span> tmp = <span class="number">3</span>;
    <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">(y)</span> {</span>
        alert(x + y + (++tmp));
    }
    bar(<span class="number">10</span>);
}
foo(<span class="number">2</span>);
</pre></td></tr></table></figure>

<p><code>foo(2)</code>无论执行多少次，其结果都是alert 16。</p>
<p>原因在于，<code>foo</code>函数并没有劫持什么变量。对于<code>bar</code>函数而言，它在<code>foo</code>函数内部，虽然访问了<code>tmp</code>，但是立即执行了，所以，也没有劫持<code>tmp</code>。</p>
<p>但是，如果这么做的话，结果就不一样了：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(x)</span> {</span>
    <span class="keyword">var</span> tmp = <span class="number">3</span>;
    <span class="comment">//返回匿名函数</span>
    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span><span class="params">(y)</span> {</span>
        alert(x + y + (++tmp));
    };
}
<span class="keyword">var</span> bar=foo(<span class="number">2</span>);<span class="comment">//将匿名函数赋值给bar变量，艾玛，这个太绝了</span>
bar(<span class="number">10</span>);
</pre></td></tr></table></figure>

<p>对比两个示例，第二个示例把第一个在函数内部执行的<code>bar</code>函数拿到了外面执行。<br>上面的脚本最终也会alert 16，因为虽然<code>bar</code>不直接处于<code>foo</code>的内部作用域，但<code>bar</code>还是能访问<code>x</code>和<code>tmp</code>。<br>但是，由于tmp仍存在于bar闭包的内部，所以它还是会自加1，而且你每次调用bar时它都会自加1。</p>
<p>上面的值传递闭包示例，都是内部函数对其外部变量的“劫持”，这个外部变量在外部函数的内部。</p>
<p>下面给出另一个示例，外部变量是外部函数传参的形式。如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="function"><span class="keyword">function</span> <span class="title">makeAdder</span><span class="params">(x)</span> {</span>
  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(y)</span> {</span>
    <span class="keyword">return</span> x + y;
  };
}

<span class="keyword">var</span> add5 = makeAdder(<span class="number">5</span>);
<span class="keyword">var</span> add10 = makeAdder(<span class="number">10</span>);

print(add5(<span class="number">2</span>));  <span class="comment">// 7</span>
print(add10(<span class="number">2</span>)); <span class="comment">// 12</span>
</pre></td></tr></table></figure>

<p>再给出另一个示例，此示例将内部函数访问的局部变量声明在该函数后面，用来说明闭包环境的异步性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre><span class="keyword">var</span> f=<span class="function"><span class="keyword">function</span><span class="params">(x)</span>{</span>
  <span class="keyword">var</span> fi=<span class="function"><span class="keyword">function</span><span class="params">(y)</span>{</span>
    <span class="keyword">return</span> a+y;
  };
  <span class="keyword">var</span> a=x;
  <span class="keyword">return</span> fi;
};
<span class="keyword">var</span> ff=f(<span class="number">2</span>);
ff(<span class="number">3</span>);<span class="comment">//5</span>
</pre></td></tr></table></figure>

<p>但是，如果这么写，就不对了。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
</pre></td><td class="code"><pre><span class="keyword">var</span> f=<span class="function"><span class="keyword">function</span><span class="params">(x)</span>{</span>
  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(y)</span>{</span>
    <span class="keyword">return</span> a+y;
  };
  <span class="keyword">var</span> a=x;
};
<span class="keyword">var</span> ff=f(<span class="number">2</span>);
ff(<span class="number">3</span>);<span class="comment">//5</span>
</pre></td></tr></table></figure>

<p>在变量声明之前就返回了函数体，赋值行为就无法继续进行了。</p>
<h3 id="2-引用传递情形">2.引用传递情形</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="code"><pre><span class="function"><span class="keyword">function</span> <span class="title">foo</span><span class="params">(x)</span> {</span>
  <span class="keyword">var</span> tmp = <span class="number">3</span>;
  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(y)</span> {</span>
    alert(x + y + tmp);
    x.memb = x.memb ? x.memb + <span class="number">1</span> : <span class="number">1</span>;
    alert(x.memb);
  };
}
<span class="keyword">var</span> age = <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">2</span>);
<span class="keyword">var</span> bar = foo(age); <span class="comment">// bar 现在是一个引用了age的闭包</span>
bar(<span class="number">10</span>);
</pre></td></tr></table></figure>

<p>尼玛，每执行一次<code>bar(10)</code>，<code>age</code>对象的<code>memb</code>属性都在加一啊！</p>
<h2 id="三、独立性">三、独立性</h2>
<p><code>f1</code>和<code>f2</code>都劫持了<code>n</code>，但是，彼此不是同一环境，所以互不影响。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre><span class="keyword">var</span> f=<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">var</span> n=<span class="number">0</span>;
    <span class="keyword">var</span> count=<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        <span class="keyword">return</span> n++;
    };
    <span class="keyword">return</span> count;
};
<span class="keyword">var</span> f1=f();
<span class="keyword">var</span> f2=f();

f1();<span class="comment">//0</span>
f1();<span class="comment">//1</span>
f2();<span class="comment">//0</span>
f2();<span class="comment">//1</span>
</pre></td></tr></table></figure>


<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="code"><pre><span class="function"><span class="keyword">function</span> <span class="title">f</span><span class="params">()</span> {</span>
    <span class="keyword">var</span> rs = [];

    <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt;<span class="number">10</span>; i++) {
        rs[i] = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
            <span class="keyword">return</span> i;
        };
    }

    <span class="keyword">return</span> rs;
}

<span class="keyword">var</span> fn = f();

<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; fn.length; i++) {
    console.log(<span class="string">'函数fn['</span> + i + <span class="string">']()返回值:'</span> + fn[i]());
}
</pre></td></tr></table></figure>

<p>运行结果：</p>
<p>函数fn<a href="">0</a>返回值:10<br>函数fn<a href="">1</a>返回值:10<br>函数fn<a href="">2</a>返回值:10<br>函数fn<a href="">3</a>返回值:10<br>函数fn<a href="">4</a>返回值:10<br>…<br>函数fn<a href="">9</a>返回值:10</p>
<p>原因：</p>
<p><code>fn</code>得到的其实是个存放了10个相同返函数的数组：[function(){return i;},function(){return i;},function(){return i;}…]</p>
<p>函数会返回一个数组，表面上看，似乎每个函数都应该返回自己的索引值，实际上，每个函数都返回10，这是因为第个函数的作用域链上都保存着函数f的活动对象，它们引用的都是同一变量i。当函数f返回后，变量i的值为10，此时每个函数都保存着变量i的同一个变量对象。我们可以通过创建另一个匿名函数来强制让闭包的行为符合预期。</p>
<h2 id="四、不带返回函数的情形">四、不带返回函数的情形</h2>
<p>1.常见的循环中的事件操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="keyword">var</span> lists = document.querySelectorAll(<span class="string">'#items&gt;li'</span>);
<span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, j = lists.length; i &lt; j; i++) {
    lists[i].onclick = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        alert(i);
        <span class="comment">// console.log(this.i);</span>
    };
}
</pre></td></tr></table></figure>

<p>2.循环中的timer</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;<span class="number">6</span>;i++){
    <span class="comment">// var tmp=i;</span>
    setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        console.log(tmp);
    },<span class="number">6000</span>);
}
</pre></td></tr></table></figure>

<h2 id="五、应用">五、应用</h2>
<h3 id="1-创建漂亮的get/set语法糖">1.创建漂亮的<code>get/set</code>语法糖</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="keyword">var</span> db = (<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
<span class="comment">// 创建一个隐藏的object, 这个object持有一些数据</span>
<span class="comment">// 从外部是不能访问这个object的</span>
<span class="keyword">var</span> data = {};
<span class="comment">// 创建一个函数, 这个函数提供一些访问data的数据的方法</span>
<span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(key, val)</span> {</span>
    <span class="keyword">if</span> (val === <span class="literal">undefined</span>) { <span class="keyword">return</span> data[key] } <span class="comment">// get</span>
    <span class="keyword">else</span> { <span class="keyword">return</span> data[key] = val } <span class="comment">// set</span>
    }
<span class="comment">// 我们可以调用这个匿名方法</span>
<span class="comment">// 返回这个内部函数，它是一个闭包</span>
})();

db(<span class="string">'x'</span>); <span class="comment">// 返回 undefined</span>
db(<span class="string">'x'</span>, <span class="number">1</span>); <span class="comment">// 设置data['x']为1</span>
db(<span class="string">'x'</span>); <span class="comment">// 返回 1</span>
<span class="comment">// 我们不可能访问data这个object本身</span>
<span class="comment">// 但是我们可以设置它的成员</span>
</pre></td></tr></table></figure>

<h2 id="五、总结">五、总结</h2>
<p>如果一个函数访问了它的外部变量，那么它就是一个闭包。</p>
<p>注意，外部函数不是必需的。通过访问外部变量，一个闭包可以维持（keep alive）这些变量。在内部函数和外部函数的例子中，外部函数可以创建局部变量，并且最终退出；但是，如果任何一个或多个内部函数在它退出后却没有退出，那么内部函数就维持了外部函数的局部数据。</p>
<h2 id="六、参考：">六、参考：</h2>
<p><a href="http://stackoverflow.com/questions/111102/how-do-javascript-closures-work" target="_blank">http://stackoverflow.com/questions/111102/how-do-javascript-closures-work</a><br><a href="http://wlog.cn/javascript/javascript-closures.html" target="_blank">http://wlog.cn/javascript/javascript-closures.html</a><br><a href="http://segmentfault.com/q/1010000000418684" target="_blank">http://segmentfault.com/q/1010000000418684</a><br><a href="http://kb.cnblogs.com/page/110782/" target="_blank">http://kb.cnblogs.com/page/110782/</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T07:16:37.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/css-bfc/">css BFC</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="一、BFC到底是什么？">一、BFC到底是什么？</h2>
<p>当涉及到可视化布局的时候，Block Formatting Context提供了一个环境，HTML元素在这个环境中按照一定规则进行布局。一个环境中的元素不会影响到其它环境中的布局。比如浮动元素会形成BFC，浮动元素内部子元素的主要受该浮动元素影响，两个浮动元素之间是互不影响的。这里有点类似一个BFC就是一个独立的行政单位的意思。</p>
<h2 id="二、css形成BFC的条件：">二、css形成BFC的条件：</h2>
<p>英文：</p>
<blockquote>
<p>Floats, absolutely positioned elements, block containers (such as inline-blocks, table-cells, and table-captions) that are not block boxes, and block boxes with ‘overflow’ other than ‘visible’ (except when that value has been propagated to the viewport) establish new block formatting contexts for their contents.</p>
</blockquote>
<p>翻译：</p>
<p>浮动元素，定位元素（absolute|fixed），声明为 <code>inline-block</code>，<code>table-cells</code>，<code>table-captions</code>的容器，块级声明为<code>overflow:hidden</code>的盒子都可以形成<code>BFC</code>。<br>即就是：</p>
<ul>
<li>overflow:hidden(前提是display为block)</li>
<li>position:absolute|fixed</li>
<li>display:table-cell|table-captions|inline-block</li>
</ul>
<h2 id="三、应用">三、应用</h2>
<p>边距叠加，浮动清除等。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T07:14:25.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/sass-extend-placeholder/">SASS extend,mixin,%占位符区别</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="一、区别">一、区别</h2>
<p>1.<code>@extend</code>需要一个存在的类名，编译后，会做<code>css</code>样式合并。比如</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
</pre></td><td class="code"><pre><span class="class">.clearfix</span>, <span class="class">.my</span>, <span class="tag">div</span> <span class="rules">{ <span class="rule">*<span class="attribute">zoom</span>:<span class="value"> <span class="number">1</span></span></span>; <span class="rule">}</span></span>
<span class="class">.clearfix</span> <span class="pseudo">:after</span>, <span class="class">.my</span> <span class="pseudo">:after</span>, <span class="tag">div</span> <span class="pseudo">:after</span> <span class="rules">{ <span class="rule"><span class="attribute">display</span>:<span class="value"> block</span></span>; <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">clear</span>:<span class="value"> both</span></span>; <span class="rule"><span class="attribute">font-size</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">visibility</span>:<span class="value"> hidden</span></span>; <span class="rule"><span class="attribute">content</span>:<span class="value"> <span class="string">'.'</span></span></span>; <span class="rule">}</span></span>
</pre></td></tr></table></figure>

<p>2.<code>@mixin</code> 创造的规则，不会被编译到文件中，除非它被调用了。但是，调用的规则不会合并。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
</pre></td><td class="code"><pre><span class="at_rule">@<span class="keyword">mixin</span> links </span>{
    <span class="tag">a</span> <span class="rules">{
        <span class="rule"><span class="attribute">color</span>:<span class="value">blue</span></span>;
        <span class="rule"><span class="attribute">background</span>:<span class="value">red</span></span>;
    <span class="rule">}</span></span>
}
</pre></td></tr></table></figure>

<p>编译后：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre><span class="class">.mod</span> <span class="tag">a</span> <span class="rules">{ <span class="rule"><span class="attribute">color</span>:<span class="value"> blue</span></span>; <span class="rule"><span class="attribute">background</span>:<span class="value"> red</span></span>; <span class="rule">}</span></span>
<span class="class">.mod</span> <span class="pseudo">:after</span> <span class="rules">{ <span class="rule"><span class="attribute">display</span>:<span class="value"> block</span></span>; <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">clear</span>:<span class="value"> both</span></span>; <span class="rule"><span class="attribute">font-size</span>:<span class="value"> <span class="number">0</span></span></span>; <span class="rule"><span class="attribute">visibility</span>:<span class="value"> hidden</span></span>; <span class="rule"><span class="attribute">content</span>:<span class="value"> <span class="string">'.'</span></span></span>; <span class="rule">}</span></span>
<span class="class">.mod</span> <span class="rules">{ <span class="rule">*<span class="attribute">zoom</span>:<span class="value"> <span class="number">1</span></span></span>; <span class="rule">}</span></span>
<span class="class">.mod</span> <span class="tag">div</span> <span class="tag">a</span> <span class="rules">{ <span class="rule"><span class="attribute">color</span>:<span class="value"> blue</span></span>; <span class="rule"><span class="attribute">background</span>:<span class="value"> red</span></span>; <span class="rule">}</span></span>
</pre></td></tr></table></figure>

<p>3.<code>%占位符</code>创造的规则，不会被编译到文件中，除非它被调用了。但是，该规则不能传参数，可以做规则合并。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="code"><pre>%mode {
    font-size:12px;
    color:#fff;
    background:#333;
    border-radius:3px;
    line-height:20px;
    height:20px;
}
.test1 {
    @extend %mode;
}
.test2 {
    @extend %mode;
}
.my {
    @extend .clearfix;
    .tit {
        @extend %mode;
    }
}
</pre></td></tr></table></figure>

<p>编译后：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
</pre></td><td class="code"><pre><span class="class">.test1</span>, <span class="class">.test2</span>, <span class="class">.my</span> <span class="class">.tit</span> <span class="rules">{ <span class="rule"><span class="attribute">font-size</span>:<span class="value"> <span class="number">12</span>px</span></span>; <span class="rule"><span class="attribute">color</span>:<span class="value"> <span class="hexcolor">#fff</span></span></span>; <span class="rule"><span class="attribute">background</span>:<span class="value"> <span class="hexcolor">#333</span></span></span>; <span class="rule"><span class="attribute">border-radius</span>:<span class="value"> <span class="number">3</span>px</span></span>; <span class="rule"><span class="attribute">line-height</span>:<span class="value"> <span class="number">20</span>px</span></span>; <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">20</span>px</span></span>; <span class="rule">}</span></span>
</pre></td></tr></table></figure>

<h2 id="二、其它注意事项">二、其它注意事项</h2>
<p>选择器占位符的限制<br>使用@extend调用定义好的选择器占位符%placeholder有所限制，他不能在不同的@media中运行。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre>%icon {
  transition: background-color ease .2s;
  margin: 0 .5em;
}

@media screen {
  .error-icon {
    @extend %icon;
  }

  .info-icon {
    @extend %icon;
  }
}
</pre></td></tr></table></figure>

<p>此时编译你的SCSS文件时，编译器将会报错。</p>
<p>参考：<a href="http://www.w3cplus.com/preprocessor/understanding-placeholder-selectors.html" target="_blank">http://www.w3cplus.com/preprocessor/understanding-placeholder-selectors.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T07:10:38.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/sass-learning/">SASS使用学习</a></h1>
  

    </header>
    <div class="entry">
      
        <p>1.变量声明：<code>$</code>开头，写在css属性中时需要写在<code>#{}</code>中。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
</pre></td><td class="code"><pre>$side : left;
　　.rounded {
　　　　border-#{$side}-radius: 5px;
　　}
</pre></td></tr></table></figure>

<p>2.计算：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre><span class="tag">body</span> <span class="rules">{
　　　　<span class="rule"><span class="attribute">margin</span>:<span class="value"> (<span class="number">14</span>px/<span class="number">2</span>)</span></span>;
　　　　<span class="rule"><span class="attribute">top</span>:<span class="value"> <span class="number">50</span>px + <span class="number">100</span>px</span></span>;
　　　　<span class="rule"><span class="attribute">right</span>:<span class="value"> $var * <span class="number">10</span>%</span></span>;
　　<span class="rule">}</span></span>
</pre></td></tr></table></figure>

<p>3.嵌套：<br>选择器嵌套，比如 div h1：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>div {
    h1 {
        color:#fff;
    }
}
</pre></td></tr></table></figure>

<p>属性嵌套：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
</pre></td><td class="code"><pre><span class="tag">div</span> <span class="rules">{
    <span class="rule"><span class="attribute">border</span>:<span class="value">{
        width:<span class="number">1</span>px</span></span>;
        <span class="rule"><span class="attribute">color</span>:<span class="value">red</span></span>;
        <span class="rule"><span class="attribute">style</span>:<span class="value">solid</span></span>;
    <span class="rule">}</span></span>
}
</pre></td></tr></table></figure>

<p>嵌套回归，使用<code>&amp;</code>符号来标识当前的选择器：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre>.clearfix {
    :after {
        display:block;
        height: 0;
        clear:both;
        font-size:0;
        visibility:hidden;
        content:'.';
    }
    & {
        *zoom: 1;
    }
}
</pre></td></tr></table></figure>

<p>4.@mixin<br>有两种形式，一种是mixin整个选择器，另一种是mixin 定义一个规则。<br>A. 定义一个规则</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="code"><pre><span class="at_rule">@<span class="keyword">mixin</span> clearfix </span>{
    <span class="pseudo">:after</span> <span class="rules">{
        <span class="rule"><span class="attribute">display</span>:<span class="value">block</span></span>;
        <span class="rule"><span class="attribute">height</span>:<span class="value"> <span class="number">0</span></span></span>;
        <span class="rule"><span class="attribute">clear</span>:<span class="value">both</span></span>;
        <span class="rule"><span class="attribute">font-size</span>:<span class="value"><span class="number">0</span></span></span>;
        <span class="rule"><span class="attribute">visibility</span>:<span class="value">hidden</span></span>;
        <span class="rule"><span class="attribute">content</span>:<span class="value"><span class="string">'.'</span></span></span>;
    <span class="rule">}</span></span>
    & <span class="rules">{
        <span class="rule">*<span class="attribute">zoom</span>:<span class="value"> <span class="number">1</span></span></span>;
    <span class="rule">}</span></span>
}
</pre></td></tr></table></figure>

<p>B.定义整个选择器</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre>@mixin links {
    a {
        color:blue;
        background:red;
    }
}
.mod {
    @include links;
    @include clearfix;
}
</pre></td></tr></table></figure>

<p>5.@extend.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="code"><pre>.clearfix {
  *zoom: 1;
  :after {
    display:block;
    height: 0;
    clear:both;
    font-size:0;
    visibility:hidden;
    content:'.';
  }
}
div {
  @extend .clearfix;
}
</pre></td></tr></table></figure>

<p>6.选择占位符:<code>%名称</code></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="code"><pre>%mode {
    font-size:12px;
    color:#fff;
    background:#333;
    border-radius:3px;
    line-height:20px;
    height:20px;
}

.my {
    @extend .clearfix;
    .tit {
        @extend %mode;
    }
}
</pre></td></tr></table></figure>

<p>7.!default</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>$a:16px!default;
$a:12px;
body {
    font-size:$a;//12px
}
</pre></td></tr></table></figure>

<p>使用了<code>!default</code>语法，变量未定义时，将使用当前赋值；否则，使用已经定义的值。<br>从运行结果来看，同一变量是否定义，是通过全局来看的。</p>
<p>8.函数定义：<code>@function</code></p>
<p>若要返回，注意<code>@return</code>，参数变量使用<code>$col</code>。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
</pre></td><td class="code"><pre>$baseWidth:1200px;
@function widthControl($col){
    @return $baseWidth/$col;
}
@for $i from 1 through 12 {
    .col-#{$i} {
        width:widthControl($i);
    }
}
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T07:02:45.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/html5-storage/">HTML5 storage</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="概念：">概念：</h2>
<p>html5中存在<code>localStorage</code>对象（本地存储）和<code>sessionStorage</code>对象。</p>
<p><code>localStorage</code>对象，既然是本地存储，自然是长久存在了。无论页面刷新，还是窗口关闭，始终存在。与cookie对象不同的是，该对象无法设置过期。</p>
<p><code>sessionStorage</code>对象，和后端语言中的session差不多，浏览器关闭了，其值就删除了。</p>
<h2 id="浏览器支持情况：">浏览器支持情况：</h2>
<ul>
<li>IE8+（包括IE8）</li>
<li>FF3.0+</li>
<li>chrome4.0+</li>
<li>safari4.0+</li>
</ul>
<h2 id="大小限制">大小限制</h2>
<p>5MB</p>
<h2 id="API操作：">API操作：</h2>
<h3 id="localStorage">localStorage</h3>
<hr>
<ul>
<li>set:<code>localStorage.setItem(&#39;name&#39;,&#39;xiaoming&#39;)</code></li>
<li>get:<code>localStorage.getItem(&#39;name&#39;)</code></li>
<li>remove:<code>localStorage.removeItem(&#39;name&#39;)</code></li>
</ul>
<p>与cookie对象删除需要设置过期时间不同的是，localStorage对象只需要使用<code>removeItem</code>方法即可。</p>
<h3 id="sessionStorage">sessionStorage</h3>
<hr>
<ul>
<li>set:<code>sessionStorage.setItem(&#39;name&#39;,&#39;xiaoming&#39;)</code></li>
<li>get:<code>sessionStorage.getItem(&#39;name&#39;)</code></li>
</ul>
<h3 id="注意事项：">注意事项：</h3>
<p>同cookie获取类似，我们获取到的对象值为字符串，所以，是数字的话，请转化成数字格式</p>
<h2 id="代码：">代码：</h2>
<p>写了一段测试代码，功能主要是记录用户选择了哪个按钮。<a href="http://jsfiddle.net/xmlovecss/8UBgC/" target="_blank">在线demo</a></p>
<p>代码如下：</p>
<hr>
<p>html:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
</pre></td><td class="code"><pre><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"wrapper1"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span> <span class="attribute">class</span>=<span class="value">"selected-info"</span>&gt;</span>你选中的是：<span class="tag">&lt;<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span>
    <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"a"</span>&gt;</span>a<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
    <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"b"</span>&gt;</span>b<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"wrapper2"</span>&gt;</span>
    <span class="tag">&lt;<span class="title">p</span> <span class="attribute">class</span>=<span class="value">"selected-info"</span>&gt;</span>你选中的是：<span class="tag">&lt;<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">span</span>&gt;</span><span class="tag">&lt;/<span class="title">p</span>&gt;</span>
    <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"a"</span>&gt;</span>a<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
    <span class="tag">&lt;<span class="title">button</span> <span class="attribute">class</span>=<span class="value">"b"</span>&gt;</span>b<span class="tag">&lt;/<span class="title">button</span>&gt;</span>
<span class="tag">&lt;/<span class="title">div</span>&gt;</span>
</pre></td></tr></table></figure>

<p>javascript：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre></td><td class="code"><pre>(<span class="function"><span class="keyword">function</span><span class="params">(window,$,undefined)</span>{</span>
    $(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        <span class="comment">// sessionStorage</span>
        <span class="keyword">var</span> setSelected=<span class="function"><span class="keyword">function</span><span class="params">(sOpt)</span>{</span>
            <span class="keyword">if</span>(window.sessionStorage){
                sessionStorage.setItem(<span class="string">'selectedName'</span>,sOpt);
            }
        };
        <span class="keyword">var</span> f1=<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
            $(<span class="keyword">this</span>).addClass(<span class="string">'current'</span>).siblings().removeClass(<span class="string">'current'</span>);
            <span class="keyword">var</span> selectS=$(<span class="keyword">this</span>).text();
            setSelected(selectS);
        };
        
        $(<span class="string">'.wrapper1 button'</span>).on(<span class="string">'click'</span>,f1);
        setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
            <span class="keyword">var</span> selectedS=sessionStorage.getItem(<span class="string">'selectedName'</span>)||<span class="string">''</span>;
            $(<span class="string">'.wrapper1 .selected-info span'</span>).text(selectedS);
            !!selectedS&&$(<span class="string">'.wrapper1 button:contains("'</span>+selectedS+<span class="string">'")'</span>).addClass(<span class="string">'current'</span>);
        },<span class="number">300</span>);
    });
    <span class="comment">// localStorage 测试</span>
    $(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
        <span class="keyword">var</span> setSelected=<span class="function"><span class="keyword">function</span><span class="params">(sOpt)</span>{</span>
            <span class="keyword">if</span>(window.localStorage){
                localStorage.selectedName=sOpt;
            }
        };
        <span class="keyword">var</span> f1=<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
            $(<span class="keyword">this</span>).addClass(<span class="string">'current'</span>).siblings().removeClass(<span class="string">'current'</span>);
            <span class="keyword">var</span> selectS=$(<span class="keyword">this</span>).text();
            setSelected(selectS);
        };
        $(<span class="string">'.wrapper2 button'</span>).on(<span class="string">'click'</span>,f1);
        setInterval(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
            <span class="keyword">var</span> selectedS= localStorage.selectedName ||<span class="string">''</span>;
            $(<span class="string">'.wrapper2 .selected-info span'</span>).text(selectedS);
            !!selectedS&&$(<span class="string">'.wrapper2 button:contains("'</span>+selectedS+<span class="string">'")'</span>).addClass(<span class="string">'current'</span>);
        },<span class="number">300</span>);
    });
})(window,jQuery);
</pre></td></tr></table></figure>


      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T06:59:07.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/javascript-practice-notes/">《编写可维护的javascript》读书总结</a></h1>
  

    </header>
    <div class="entry">
      
        <p>总体来看，书分为三个部分来阐述：</p>
<p>1.编程风格<br>2.编程实践<br>3.自动化</p>
<h2 id="一、编程风格">一、编程风格</h2>
<p>编程风格应当是所有语言都会涉及的话题了。比如：代码书写格式，语句和表达式，注释等。<br>这几个环节要进行统一约束的话，还是需要借助工具。比如好的编辑器（<code>webstorm</code>），编译语言（<code>coffeeScript</code>）。<br>所以，这里应当还是比较容易处理的。</p>
<h2 id="二、编程实践">二、编程实践</h2>
<p>对于<code>javascript</code>来说，好的编程实践还是可以总结出一些能引起“共鸣”的点的。现罗列如下：</p>
<p>1.UI层的松散耦合。</p>
<p>其实就是html，css，javascript各司其职，看似容易，其实做起来也不容易。</p>
<p>好在，前端也出现了比较成熟的<code>MVC</code>，<code>MVVM</code>框架。比如：<code>Backbone</code>，<code>Emberjs</code>，和最近很火的<code>Angularjs</code>。</p>
<p>2.全局变量的避免。</p>
<p>这个处理，除了匿名函数（无法和其它模块沟通），命名空间之外，最著名的莫过于国外的基于AMD规范的<code>require</code>和国内基于Commonjs 规范的<code>seajs</code>了。</p>
<p>3.事件处理</p>
<p>隔离事件逻辑，不分发事件对象。</p>
<p>“隔离事件逻辑”是为了代码复用和容易测试（我还没做过前端的js自动化测试，所以这点待验证）。<br>“不分发事件对象”，这个是指应用逻辑不应当依赖于<code>event</code>对象来正确完成功能。它应当交给事件处理函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="code"><pre><span class="keyword">var</span> myApp = {
    handleEvent: <span class="function"><span class="keyword">function</span><span class="params">(e)</span> {</span>
        e.preventDefault();
        <span class="keyword">this</span>.getClient(e.clien, e.clientY);
    },
    getClient: <span class="function"><span class="keyword">function</span><span class="params">(x, y)</span> {</span>
        <span class="keyword">return</span> {
            left: x,
            top: y
        }
    }
};
document.body.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span><span class="params">(e)</span> {</span>
    myApp.handleEvent(e);
});
</pre></td></tr></table></figure>

<p>4.空比较的避免<br>5.抽离配置数据<br>6.抛出自定义错误<br>7.浏览器嗅探<br>8.不是你的对象，你不要动</p>
<p><strong>请牢记，如果你的代码没有创建这些对象，不要修改他们。包括：</strong></p>
<ul>
<li>原生对象（Object，Array等）</li>
<li>DOM对象</li>
<li>浏览器对象模型（BOM）</li>
<li>类库的对象</li>
</ul>
<p><strong>原则为：</strong></p>
<ul>
<li>不重写方法</li>
<li>不新增方法</li>
<li>不删除方法</li>
</ul>
<p><strong>更好的途径：</strong></p>
<ul>
<li>基于对象的继承</li>
<li>基于类型的继承</li>
<li>门面模式</li>
</ul>
<h2 id="三、自动化">三、自动化</h2>
<p>目前来看，我个人实践缺乏的是：</p>
<p>1.文档化<br>2.自动化测试</p>
<p>我已经用<code>grunt</code>做了文件合并依赖压缩打包的工作。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2014-05-09T06:02:12.000Z">5月 9 2014</time>
      
      
  
    <h1 class="title"><a href="/2014/05/09/jquery-deferred/">jquery promise 实践</a></h1>
  

    </header>
    <div class="entry">
      
        <p>jquery中的promise实现比较繁琐，API接口太多。使用就不够方便。自己每次在使用时，都有些不太上手的感觉。<br>今天就总结一下，方便使用。</p>
<h2 id="一、常用方法">一、常用方法</h2>
<p>给出常见的两种使用方法：</p>
<p>1.<code>deferred.done(callback).failed(callback).progress(callback)</code><br>2.<code>$.when(deferredCallback).then(doneCallback,failedCallback,progressCallback)</code></p>
<p>对于如何触发deferred对象对应的三种状态，给出如下：</p>
<p><img src="http://xiaomingming.qiniudn.com/blog-jquery-promise1.png" alt="promise状态及触发条件"></p>
<p>触发方法    触发回调<br>def.notify()/def.notifyWith()   def.progress()<br>def.reject()    def.fail()<br>def.resolve()   def.done()</p>
<p>由于jquery 中ajax本身就是deferred对象，因此调用时，就没必要实例化了(var def=$.Deferred())。</p>
<p>对于绑定了动画的dom，链式绑定<code>promise()</code>方法，当动画处理完成，就可以调用事件处理方法了。</p>
<blockquote>
<p>You call promise on a jQuery selection, and you’ll get an object that you can bind event handlers to, when all the animations in the object have completed.</p>
</blockquote>
<p>代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
</pre></td><td class="code"><pre>$(<span class="string">'div.special'</span>).fadeIn(<span class="number">5000</span>).promise().then(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">// run when the animation succeeds</span>
}).then(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="comment">// also run when the animation succeeds</span>
});
</pre></td></tr></table></figure>

<h2 id="二、代码示例">二、代码示例</h2>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre>1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="code"><pre>$(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
    <span class="keyword">var</span> defCallback=<span class="function"><span class="keyword">function</span><span class="params">(a)</span>{</span>
        <span class="keyword">var</span> def=$.Deferred();
        setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span>{</span>
            <span class="keyword">if</span>(a&lt;<span class="number">2</span>){
                def.reject(<span class="string">'reject'</span>);
            }<span class="keyword">else</span> <span class="keyword">if</span>(a===<span class="number">2</span>){
                def.resolve(<span class="string">'resolve'</span>);
            }<span class="keyword">else</span> {
                def.notify(<span class="string">'progress...'</span>);
            }
        },<span class="number">3000</span>);
        <span class="keyword">return</span> def;
    };
    <span class="keyword">var</span> res=<span class="function"><span class="keyword">function</span><span class="params">(r)</span>{</span>
        console.log(r);
    };
    $.when(defCallback(<span class="number">2</span>))
    .progress(res)
    .done(res)
    .fail(res);
});
</pre></td></tr></table></figure>

<p>参考：</p>
<p><a href="http://stackoverflow.com/questions/6080050/how-does-jquerys-promise-method-really-work" target="_blank">http://stackoverflow.com/questions/6080050/how-does-jquerys-promise-method-really-work</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


  

  <nav id="pagination">
  
  
  <div class="clearfix"></div>
</nav>
</div></div>
    <aside id="sidebar" class="alignright">
<div class="search">
  <form action="http://google.com/search" method="get" accept-charset="utf-8">
    <input type="text" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:xiaomingming.github.io">
  </form>
</div>


<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/css/">css</a><small>2</small></li>
  
    <li><a href="/categories/html5/">html5</a><small>1</small></li>
  
    <li><a href="/categories/javascript/">javascript</a><small>3</small></li>
  
    <li><a href="/categories/jquery/">jquery</a><small>1</small></li>
  
    <li><a href="/categories/sass/">sass</a><small>1</small></li>
  
  </ul>
</div>



<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <a href="/tags/BFC/"><li>BFC<small>1</small></li></a>
  
    <a href="/tags/storage/"><li>storage<small>1</small></li></a>
  
    <a href="/tags/闭包/"><li>闭包<small>1</small></li></a>
  
    <a href="/tags/读书笔记/"><li>读书笔记<small>1</small></li></a>
  
    <a href="/tags/promise/"><li>promise<small>1</small></li></a>
  
    <a href="/tags/javascript/"><li>javascript<small>1</small></li></a>
  
    <a href="/tags/sass/"><li>sass<small>2</small></li></a>
  
  </ul>
</div>



</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2014 xiaoming
  
  <br />
  Powered by <a href="http://zespia.tw/hexo/">Hexo</a>
</div>
<div class="alignright license">
<img alt="知识共享许可协议" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /> 本站作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.zh">知识共享署名-非商业性使用-相同方式共享 3.0 未本地化版本许可协议</a>进行许可。
</div>
<div class="clearfix"></div>
<script>
  $(function(){
    var gotoEle=$('#goto-top');
    $(document).scroll(function(){
        var scrollTop=$(this).scrollTop();
        if(scrollTop>0){
            gotoEle.fadeIn();
        }
    });
    gotoEle.on('click',function(e){
        $('html,body').animate({
            scrollTop:0
        },600).promise().then(function(){
            gotoEle.fadeOut();
        });
    });
  });
</script>
</footer>
  <script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>